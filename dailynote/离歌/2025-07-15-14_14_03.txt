[2025-07-15] - 离歌
事件标题: 生产环境资配系统 ORA-00054 批处理报错事件
记录人: 离歌
日期: 2025-07-15
问题描述: 生产环境资配系统批处理作业在执行 TRUNCATE TABLE 操作时，因目标表仍被 INSERT 事务占用并持有行级锁，导致 ORA-00054 (资源正忙) 错误，作业执行失败。
根本原因: TRUNCATE (DDL) 操作需要获取表级排他锁，与 INSERT (DML) 操作的锁发生冲突。由于 TRUNCATE 默认以 NOWAIT 方式执行，无法等待锁资源释放，因此立即报错退出。
解决方案与计划:
1. 短期措施: 调整批处理与数据插入任务的调度时间，进行错峰执行，以快速恢复服务稳定性。
2. 长期措施: 规划研究采用表分区交换 (Partition Exchange) 或临时表切换的方案，从架构层面根除此类锁冲突问题，提升系统鲁棒性。