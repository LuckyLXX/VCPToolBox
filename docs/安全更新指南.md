# VCP ä»£ç å®‰å…¨æ›´æ–°æŒ‡å—

## ğŸ¯ ç›®æ ‡
ç¡®ä¿åœ¨æ›´æ–°ä»£ç æ—¶ä¿æŠ¤æœ¬åœ°ä¿®æ”¹ï¼Œé¿å…é‡è¦é…ç½®å’Œè‡ªå®šä¹‰å†…å®¹ä¸¢å¤±ã€‚

## âš ï¸ å¸¸è§é—®é¢˜
1. **æœ¬åœ°ä¿®æ”¹è¢«è¦†ç›–**ï¼šè¿œç¨‹æ›´æ–°è¦†ç›–äº†æœ¬åœ°çš„è‡ªå®šä¹‰é…ç½®
2. **ç›¸åŒæ–‡æœ¬é‡å¤**ï¼šæ›´æ–°æ—¶äº§ç”Ÿé‡å¤å†…å®¹
3. **é…ç½®ä¸¢å¤±**ï¼šä¸ªäººé…ç½®æ–‡ä»¶è¢«é‡ç½®
4. **æ’ä»¶å¤±æ•ˆ**ï¼šè‡ªå®šä¹‰æ’ä»¶è¢«åˆ é™¤

## ğŸ›¡ï¸ å®‰å…¨æ›´æ–°æµç¨‹

### æ­¥éª¤1ï¼šæ›´æ–°å‰æ£€æŸ¥
```bash
# 1. æ£€æŸ¥å½“å‰çŠ¶æ€
git status

# 2. æŸ¥çœ‹æœ¬åœ°ä¿®æ”¹
git diff

# 3. æ£€æŸ¥æœªè·Ÿè¸ªæ–‡ä»¶
git ls-files --others --exclude-standard
```

### æ­¥éª¤2ï¼šå¤‡ä»½é‡è¦æ–‡ä»¶
```bash
# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p backup/$(date +%Y%m%d_%H%M%S)

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp config.env backup/$(date +%Y%m%d_%H%M%S)/
cp -r Agent/ backup/$(date +%Y%m%d_%H%M%S)/
cp -r Plugin/*/config.env backup/$(date +%Y%m%d_%H%M%S)/plugin_configs/
cp -r TVStxt/ backup/$(date +%Y%m%d_%H%M%S)/
```

### æ­¥éª¤3ï¼šæ™ºèƒ½æš‚å­˜
```bash
# æš‚å­˜æ‰€æœ‰æœ¬åœ°ä¿®æ”¹
git stash push -m "æ›´æ–°å‰å¤‡ä»½: $(date +%Y%m%d_%H%M%S)"

# æŸ¥çœ‹æš‚å­˜åˆ—è¡¨
git stash list
```

### æ­¥éª¤4ï¼šå®‰å…¨æ›´æ–°
```bash
# è·å–è¿œç¨‹æ›´æ–°
git fetch upstream

# æŸ¥çœ‹æ›´æ–°å†…å®¹
git log --oneline HEAD..upstream/main

# æ‰§è¡Œæ›´æ–°
git merge upstream/main
```

### æ­¥éª¤5ï¼šæ™ºèƒ½æ¢å¤
```bash
# æŸ¥çœ‹å†²çªæ–‡ä»¶
git status

# æ¢å¤é‡è¦é…ç½®ï¼ˆé€‰æ‹©æ€§ï¼‰
git checkout stash@{0} -- config.env
git checkout stash@{0} -- Agent/
git checkout stash@{0} -- TVStxt/filetool.txt
```

## ğŸ“‹ é‡è¦æ–‡ä»¶æ¸…å•

### ğŸ”’ å¿…é¡»ä¿æŠ¤çš„æ–‡ä»¶
- `config.env` - ä¸»é…ç½®æ–‡ä»¶
- `Agent/*.txt` - è‡ªå®šä¹‰Agent
- `Plugin/*/config.env` - æ’ä»¶é…ç½®
- `TVStxt/filetool.txt` - å·¥å…·è¯´æ˜
- `AppData/` - åº”ç”¨æ•°æ®ï¼ˆVCPChatï¼‰

### âš¡ å¯ä»¥æ›´æ–°çš„æ–‡ä»¶
- `server.js` - ä¸»æœåŠ¡å™¨
- `Plugin.js` - æ’ä»¶ç®¡ç†å™¨
- `WebSocketServer.js` - WebSocketæœåŠ¡
- `Plugin/*/plugin-manifest.json` - æ’ä»¶æ¸…å•
- `Plugin/*/*.js` - æ’ä»¶ä»£ç 

### ğŸ”„ éœ€è¦åˆå¹¶çš„æ–‡ä»¶
- `README.md` - é¡¹ç›®è¯´æ˜
- `package.json` - ä¾èµ–é…ç½®
- `Plugin/*/README.md` - æ’ä»¶è¯´æ˜

## ğŸ¤– AIè‡ªåŠ¨æ›´æ–°è„šæœ¬

### æ£€æŸ¥é˜¶æ®µ
```javascript
// æ£€æŸ¥æœ¬åœ°ä¿®æ”¹
const localChanges = await checkLocalChanges();
if (localChanges.length > 0) {
    console.log('å‘ç°æœ¬åœ°ä¿®æ”¹:', localChanges);
    await backupChanges(localChanges);
}
```

### å¤‡ä»½é˜¶æ®µ
```javascript
// æ™ºèƒ½å¤‡ä»½
const protectedFiles = [
    'config.env',
    'Agent/*.txt', 
    'Plugin/*/config.env',
    'TVStxt/filetool.txt'
];

await backupFiles(protectedFiles);
```

### æ›´æ–°é˜¶æ®µ
```javascript
// å®‰å…¨æ›´æ–°
await gitStash('æ›´æ–°å‰è‡ªåŠ¨å¤‡ä»½');
await gitFetch('upstream');
await gitMerge('upstream/main');
```

### æ¢å¤é˜¶æ®µ
```javascript
// é€‰æ‹©æ€§æ¢å¤
const conflicts = await checkConflicts();
for (const file of protectedFiles) {
    if (conflicts.includes(file)) {
        await selectiveRestore(file);
    }
}
```

## ğŸ“ æ›´æ–°æ£€æŸ¥æ¸…å•

### æ›´æ–°å‰ âœ…
- [ ] æ£€æŸ¥gitçŠ¶æ€
- [ ] å¤‡ä»½é‡è¦é…ç½®
- [ ] è®°å½•æœ¬åœ°ä¿®æ”¹
- [ ] åˆ›å»ºæ—¶é—´æˆ³å¤‡ä»½

### æ›´æ–°ä¸­ âœ…  
- [ ] ä½¿ç”¨git stashä¿æŠ¤ä¿®æ”¹
- [ ] è·å–è¿œç¨‹æ›´æ–°ä¿¡æ¯
- [ ] æ£€æŸ¥æ›´æ–°å†…å®¹
- [ ] æ‰§è¡Œå®‰å…¨åˆå¹¶

### æ›´æ–°å âœ…
- [ ] æ£€æŸ¥é…ç½®æ–‡ä»¶å®Œæ•´æ€§
- [ ] éªŒè¯è‡ªå®šä¹‰Agent
- [ ] æµ‹è¯•æ’ä»¶åŠŸèƒ½
- [ ] ç¡®è®¤å·¥å…·è¯´æ˜æ­£ç¡®

## ğŸš¨ ç´§æ€¥æ¢å¤

### å¦‚æœæ›´æ–°å‡ºé”™
```bash
# å›æ»šåˆ°æ›´æ–°å‰çŠ¶æ€
git reset --hard HEAD~1

# æ¢å¤æš‚å­˜çš„ä¿®æ”¹
git stash pop

# æˆ–è€…ä»å¤‡ä»½æ¢å¤
cp backup/latest/config.env ./
cp -r backup/latest/Agent/ ./
```

### å¦‚æœé…ç½®ä¸¢å¤±
```bash
# ä»æœ€è¿‘çš„å¤‡ä»½æ¢å¤
find backup/ -name "config.env" -newer config.env | head -1 | xargs cp -t ./

# ä»gitå†å²æ¢å¤
git log --oneline --follow config.env
git checkout <commit-hash> -- config.env
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å®šæœŸå¤‡ä»½
```bash
# æ¯æ—¥è‡ªåŠ¨å¤‡ä»½è„šæœ¬
#!/bin/bash
DATE=$(date +%Y%m%d)
mkdir -p daily_backup/$DATE
cp config.env daily_backup/$DATE/
cp -r Agent/ daily_backup/$DATE/
cp -r TVStxt/ daily_backup/$DATE/
```

### 2. ç‰ˆæœ¬æ ‡è®°
```bash
# ä¸ºé‡è¦ç‰ˆæœ¬æ‰“æ ‡ç­¾
git tag -a v1.0-custom -m "ä¸ªäººå®šåˆ¶ç‰ˆæœ¬"
git tag -a v1.1-stable -m "ç¨³å®šå·¥ä½œç‰ˆæœ¬"
```

### 3. åˆ†æ”¯ç®¡ç†
```bash
# åˆ›å»ºä¸ªäººåˆ†æ”¯
git checkout -b personal-config
git add config.env Agent/ TVStxt/
git commit -m "ä¸ªäººé…ç½®å’Œè‡ªå®šä¹‰å†…å®¹"

# æ›´æ–°æ—¶åˆ‡æ¢åˆ†æ”¯
git checkout main
git pull upstream main
git checkout personal-config
git rebase main
```

## ğŸ”§ è‡ªåŠ¨åŒ–å·¥å…·

### æ›´æ–°è„šæœ¬æ¨¡æ¿
```bash
#!/bin/bash
# safe_update.sh - å®‰å…¨æ›´æ–°è„šæœ¬

echo "ğŸ” æ£€æŸ¥æ›´æ–°å‰çŠ¶æ€..."
git status --porcelain > .update_status

echo "ğŸ’¾ å¤‡ä»½é‡è¦æ–‡ä»¶..."
BACKUP_DIR="backup/$(date +%Y%m%d_%H%M%S)"
mkdir -p $BACKUP_DIR
cp config.env $BACKUP_DIR/
cp -r Agent/ $BACKUP_DIR/
cp -r TVStxt/ $BACKUP_DIR/

echo "ğŸ“¦ æš‚å­˜æœ¬åœ°ä¿®æ”¹..."
git stash push -m "è‡ªåŠ¨æ›´æ–°å‰å¤‡ä»½"

echo "ğŸ”„ è·å–è¿œç¨‹æ›´æ–°..."
git fetch upstream

echo "ğŸ“‹ æ˜¾ç¤ºæ›´æ–°å†…å®¹..."
git log --oneline HEAD..upstream/main

echo "âš¡ æ‰§è¡Œæ›´æ–°..."
git merge upstream/main

echo "ğŸ”§ æ¢å¤é‡è¦é…ç½®..."
if [ -f "$BACKUP_DIR/config.env" ]; then
    cp $BACKUP_DIR/config.env ./
fi

echo "âœ… æ›´æ–°å®Œæˆï¼"
echo "å¤‡ä»½ä½ç½®: $BACKUP_DIR"
echo "å¦‚éœ€æ¢å¤: git stash pop"
```

## ğŸ“ æ•…éšœæ’é™¤

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

1. **åˆå¹¶å†²çª**
   ```bash
   # æŸ¥çœ‹å†²çªæ–‡ä»¶
   git status
   # æ‰‹åŠ¨è§£å†³å†²çªå
   git add .
   git commit
   ```

2. **é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯**
   ```bash
   # éªŒè¯é…ç½®æ–‡ä»¶
   node -e "console.log('Config OK')" || echo "Config Error"
   ```

3. **æ’ä»¶å¤±æ•ˆ**
   ```bash
   # é‡æ–°å®‰è£…ä¾èµ–
   npm install
   # é‡å¯æœåŠ¡
   npm start
   ```

è®°ä½ï¼š**å®‰å…¨ç¬¬ä¸€ï¼Œå¤‡ä»½ä¸ºç‹ï¼** ğŸ›¡ï¸
